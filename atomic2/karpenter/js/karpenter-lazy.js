var LazyLoad=new Class({Implements:[Options,Events],options:{range:200,image:"img/blank.gif",resetDimensions:true,elements:"img",container:window,fireScroll:true,mode:"vertical",startPosition:0},initialize:function(f){this.setOptions(f);this.container=document.id(this.options.container);this.elements=$$(this.options.elements);var e=(this.options.mode=="vertical"?"y":"x");this.containerDimension=this.container.getSize()[e];this.startPosition=0;var g=(this.container!=window&&this.container!=document.body?this.container:"");this.elements=this.elements.filter(function(a){var b=a.getPosition(g)[e];if(b>this.containerDimension+this.options.range){a.store("oSRC",a.get("src")).set("src",this.options.image);if(this.options.resetDimensions){a.store("oWidth",a.get("width")).store("oHeight",a.get("height")).set({width:"",height:""})}return true}},this);var h=function(){var a=this.container.getScroll()[e];if(a>this.startPosition){this.elements=this.elements.filter(function(b){if((a+this.options.range+this.containerDimension)>=b.getPosition(g)[e]){if(b.retrieve("oSRC")){b.set("src",b.retrieve("oSRC"))}if(this.options.resetDimensions){b.set({width:b.retrieve("oWidth"),height:b.retrieve("oHeight")})}this.fireEvent("load",[b]);return false}return true},this);this.startPosition=a}this.fireEvent("scroll");if(!this.elements.length){this.container.removeEvent("scroll",h);this.fireEvent("complete")}}.bind(this);window.addEvent("scroll",h);if(this.options.fireScroll){h()}}});