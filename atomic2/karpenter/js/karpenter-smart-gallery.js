(function(b){b.fn.extend({gallery:function(a){var d=b.extend({random:true,autoscroll:false,circular:true,masked:true,animation:"blind",noofthumbnails:6,thumbnailscrollspeed:2000,animationspeed:1000,stickthumbnails:false,imagedisplaytime:3000},a);return this.each(function(){var bt;var aS;var b1;var bv=0;var bu=0;var a2=null;var bC=null;var bS;var aQ;var aK;var bE;var aW;var bV;var aZ;var bB;var aY=0;var bW=0;var aM=0;var bf=b("<div/>");var bN;var bo;var a1=d.noofthumbnails;var aP=d.thumbnailscrollspeed;var bG;var ba;var i;var a8;var bX;var bD="forward";var bH="forward";var by=true;var aT=false;var b2=0;var a0=0;var aV=0;var bp;var aX;var b0;var bT=false;var bg=["fadein","blind","fallingbars","appear","fillin","explode","jumble","risingbars","paint","diagonal","crunchingbars","slidein"];bt=b(this).addClass("min-gallery");var bK=bt.find("a");b1=bt.find("img");bK.remove();bS=b("<div/>").addClass("preview");aQ=b("<div/>").addClass("bottom");aK=b("<div/>").addClass("short");bE=b("<div/>").css("display","none").addClass("long");aW=b("<div/>").addClass("left");bV=b("<div/>").addClass("right");aZ=b("<div/>").addClass("middle");bB=b("<div/>").addClass("thumb-nails");bE.append(bB).mouseleave(function(){if(!d.stickthumbnails){if(bE.css("display")!="none"){}aK.css("display","");bQ();bE.stop(false,true).animate({marginTop:b(".bottom").height()},d.animationspeed,function(){b(this).css("display","none")})}});if(d.stickthumbnails){b("<div/>").html("close").addClass("close").click(function(){aK.css("display","");bT=false;bQ();bE.stop(false,true).animate({marginTop:b(".bottom").height()},d.animationspeed,function(){b(this).css("display","none")})}).appendTo(bE)}bK.each(function(e){b(this).addClass(""+(e+1))});b1.each(function(e){b(this).addClass(""+(e+1))});bt.append(bS).append(aQ.append(bE).append(aK.append(aW).append(aZ).append(bV)));bE.append(b("<div/>").addClass("clear-fix"));var aO=b("<div/>").addClass("thumbnails-contents");var bk=b("<div/>").addClass("thumbnails-back");var bb=b("<div/>").addClass("thumbnails-forward");bB.append(bk).append(aO).append(bb);bB.addClass("thumbnails").append(b("<div/>").addClass("clear-fix"));aY=b1.length;bN=parseInt(aY/a1);if(aY%a1>0){bN++}var bh=1;for(var be=0;be<bN;be++){aV=be*a1;a0=aV+a1;var bP;if(a0>=aY){var bl=aV;aV-=(a0-aY);a0=aY;bP=b1.slice(bl,a0);var bj=0;for(var bc=aV;bc<bl;bc++){bP.splice(bj,0,b(b1[bc]).clone(true));bj++}}else{bP=b1.slice(aV,a0)}var bI=b("<div/>");bP.each(function(f,e){bI.append(b(this))});aO.append(bI)}aO.find("img").click(function(){if(!by){bv=parseInt(b(this).attr("class").split(" ")[0])-1;bu=bS.find("img.previous").prevAll().length;if(bv!=bu){bU()}}});if(d.masked){b("img",aO).addClass("thumbnail-inactive").hover(function(){b(this).removeClass("thumbnail-inactive").addClass("thumbnail-active")},function(){b(this).removeClass("thumbnail-active").addClass("thumbnail-inactive")})}function aL(){by=false;clearTimeout(bo);bB.children().clearQueue();bB.children().stop(false,true)}function a6(){clearTimeout(bo);if(d.autoscroll){bo=setTimeout(br,d.delay)}}function br(){if(bD=="forward"){if(bW<=0){bW=bN}}else{if(bW>=bN-1){bW=-1}}bF();bo=setTimeout(br,d.delay)}function bw(e){return e+"px"}function bF(){by=true;var f=b(".visible",aO);var e=aP;if(bD=="forward"){bW--;if(bW>=0){b(">div:eq("+bW+")",aO).css("left",bw(bX)).removeClass("hidden").addClass("visible").stop(false,true).animate({left:"-="+bw(bX)},e,function(){by=false;bv=parseInt(b(this).find("img:eq(0)").attr("class").split(" ")[0])-1;bu=bS.find("img.previous").prevAll().length;bU()});f.stop(false,true).animate({left:"-="+bw(bX)},e,function(){b(this).removeClass("visible").addClass("hidden");b(this).css("left",ba);by=false})}else{bW=0}}else{if(bD=="backward"){bW++;if(bW<bN){b(">div:eq("+bW+")",aO).removeClass("hidden").addClass("visible").css({left:bw(-bX)}).stop(false,true).animate({left:"+="+bw(bX)},e,function(){by=false;bv=parseInt(b(this).find("img:eq(0)").attr("class").split(" ")[0])-1;bu=bS.find("img.previous").prevAll().length;bU()});f.stop(false,true).animate({left:"+="+bw(bX)},e,function(){b(this).removeClass("visible").addClass("hidden");b(this).css("left",bw(-bX));by=false})}else{bW=bN-1}}}}b("> div > div",aO).css("cursor","pointer");bW=0;b("> div",aO).addClass("hidden");b("> div > div",aO).css("display","");ba=b("> div:eq("+bW+")",aO).css("left");bX=aO.width();b("> div",aO).css("left","-"+bX+"px");by=false;bB.mouseenter(function(){if(d.autoscroll){aL()}}).mouseleave(function(){if(d.autoscroll){a6()}});if(d.autoscroll){a6()}bb.click(function(){if(!by){bD="forward";if(d.circular){if(bW<=0){bW=bN}}bF()}});bk.click(function(){if(!by){bD="backward";if(d.circular){if(bW>=bN-1){bW=-1}}bF()}});bS.append(b("<img/>").css({top:bS.height()/2,left:bS.width()/2}).attr("src","loading.gif"));var bx=0;for(var be=0;be<bK.length;be++){var bd=b("<img/>").attr("src",b(bK[be]).attr("href"));bd.load(function(){bx++;if(bx==bK.length){bS.find("img").remove();b.each(bK,function(e,f){bS.append(b("<img/>").css("display","none").addClass(b(f).attr("class")).attr("src",""+b(f).attr("href")+"").attr("alt",b(f).attr("title")))});aS=bS.find("img");aS.css("z-index","98");bS.find("img:eq(0)").css("z-index","101");bS.find("img:gt(0)").css("z-index","98").css("display","");bt.find("a").remove();bv=0;bu=aS.length;bQ()}})}var bL=b("<div/>").addClass("gallery-nav-left");var a7=b("<div/>").addClass("gallery-nav-right");bL.html("&nbsp;");a7.html("&nbsp;");var bJ=b("<div/>").addClass("short-thumbnail-container");aZ.append(bL).append(bJ).append(a7);for(var be=0;be<9;be++){bJ.append(b("<div/>").addClass("thumbnail-button"))}bJ.click(function(){bq();bE.css("display","").stop(false,true).animate({marginTop:0},d.animationspeed,function(){aK.css("display","none");by=false;bW=parseInt(bv/d.noofthumbnails)+1;bF()})});bL.click(function(){if(!aT){bH="backward";bq();bT=false;bQ()}});a7.click(function(){if(!aT){bH="forward";bq();bT=false;bQ()}});function bm(){if(bH=="forward"){if(bv<aS.length-1){bv++}else{bv=0}bu=bv-1;if(bu==-1){bu=aS.length-1}}else{if(bH=="backward"){if(bv>0){bv--}else{bv=aS.length-1}bu=bv+1;if(bu==aS.length){bu=0}}}}function bq(){clearInterval(b0);aT=false;by=false}function bQ(){if(!bT){bT=true;bU();bm()}b0=setInterval(function(){bU();bm()},d.imagedisplaytime)}function bZ(){if(d.random){return bg[Math.floor(Math.random()*12)]}else{return d.animation}}function bU(){if(!aT){aT=true;var e=bZ();a2=b(aS[bv]);bC=b(aS[bu]);b(".anim-wrapper",bt).remove();aS.removeClass("previous");bp=a2.attr("src");a2.addClass("previous");aX=b("<div/>").addClass("anim-wrapper").css({width:bS.width(),height:bS.height(),position:"absolute",zIndex:101});if(e!="fadein"){bS.append(aX)}if(e=="fadein"){bn()}else{if(e=="blind"){bM()}else{if(e=="fallingbars"){a3()}else{if(e=="risingbars"){bR()}else{if(e=="crunchingbars"){bY()}else{if(e=="slidein"){bz()}else{if(e=="fillin"){a5()}else{if(e=="appear"){bi()}else{if(e=="explode"){aR()}else{if(e=="jumble"){aN()}else{if(e=="diagonal"){bs()}else{if(e=="paint"){bO()}}}}}}}}}}}}aW.html(b(aS[bv]).attr("alt"));bV.html(""+(bv+1)+" of "+aS.length+"")}}function bs(){var g=Math.ceil(bS.width()/6);var k=Math.ceil(bS.height()/6);for(var f=0;f<6;f++){for(var o=0;o<6;o++){b("<div/>").addClass("dg").css({width:g,height:k,left:Math.ceil(o*g),top:Math.ceil(f*k),position:"absolute",opacity:0}).css({"background-image":"url("+bp+")","background-position":""+(-(o*g))+"px "+(-(f*k))+"px"}).appendTo(aX)}}var q=0;var e=6;var h=6;var j;var n=d.animationspeed/18;var p=new Array(17);for(var l=0;l<e+h-1;l++){p[l]=new Array();for(var m=Math.min(e,l+1)-1;m>=Math.max(0,l-h+1);m--){p[l].push((m*h)+l-m)}}c(p,n,0)}function c(h,f,j){var k=true;if(h[j]){for(var g=0;g<h[j].length;g++){var e=h[j][g];b(".anim-wrapper .dg:eq("+e+")",bt).stop(false,true).animate({opacity:1},f,function(){if(k){c(h,f,++j);if(j==11){a2.addClass("previous").css("z-index","100").fadeIn("slow",function(){bC.css("z-index","98")});aT=false}k=false}})}}}function aN(){var h=Math.ceil(bS.width()/4);var k=Math.ceil(bS.height()/4);var m=0;var g=0;for(var f=0;f<4;f++){if(f==0){m=0;g=0}if(f==1){m=bS.width()-h;g=0}if(f==2){m=0;g=bS.height()-k}if(f==4){m=bS.width()-h;g=bS.height()-k}m=Math.ceil(m);g=Math.ceil(g);for(var o=0;o<4;o++){b("<div/>").css({width:h,height:k,left:m,top:g,opacity:0,position:"absolute"}).css("background-image","url("+bp+")").addClass(" "+(o*h)+"").addClass(""+(f*k)+"").css("background-position",""+(-(o*h))+"px "+(-(f*k))+"px").appendTo(aX)}}var l=aX.find("div");var j=0;var n=d.animationspeed;var e=aU(l);b.each(e,function(r,s){var p=b(s);var t=parseFloat(p.attr("class").split(" ")[0]);var q=q=parseFloat(p.attr("class").split(" ")[1]);p.stop(false,true).animate({left:t,top:q,opacity:1},n,function(){++j;if(j==l.length){a2.addClass("previous").css("z-index","100").fadeIn("slow",function(){bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false})}})})}function a4(f,e){return(parseInt(Math.random()*10)%2)}function aU(f){var e,g,h=f.length;if(h){while(--h){g=Math.floor(Math.random()*(h+1));e=f[g];f[g]=f[h];f[h]=e}}return f}function bO(){var f=Math.ceil(bS.width()/4);var j=Math.ceil(bS.height()/4);for(var e=0;e<4;e++){for(var k=0;k<4;k++){b("<div/>").css({width:f,height:j,left:Math.ceil(k*f),top:Math.ceil(e*j),position:"absolute"}).append(b("<div/>").addClass("rboxes").css({"background-image":"url("+bp+")",width:0,height:0,opacity:0,display:"none","background-position":""+(-(k*f))+"px "+(-(e*j))+"px"})).appendTo(aX)}}var g=aX.find(".rboxes");var h=d.animationspeed/g.length;bA(g,h/2,f,j)}function bn(){aS.removeClass("previous");a2.css({"z-index":"101",opacity:0});a2.stop(true,true).animate({opacity:1},d.animationspeed,function(){if(bC!=null){bC.css("z-index","98")}b(this).addClass("previous");aT=false})}function bM(){for(var e=0;e<12;e++){b("<div/>").css({width:0,height:bS.find("img:eq(0)").height(),left:Math.ceil((e*bS.width()/12)),position:"absolute"}).css({"background-image":"url("+bp+")","background-position":""+(-(e*bS.width()/12))+"px 0px"}).appendTo(aX)}aX.find("div").animate({width:bS.width()/12},d.animationspeed,function(){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false})}function a3(){for(var h=0;h<12;h++){b("<div/>").css({width:Math.ceil(bS.width()/12),height:bS.find("img:eq(0)").height(),marginTop:-(bS.find("img:eq(0)").height()),left:Math.ceil((h*bS.width()/12)),position:"absolute",backgroundImage:"url("+bp+")",backgroundPosition:""+(-(h*bS.width()/12))+"px 0px",opacity:0}).appendTo(aX)}var e=aX.find("div");var f=d.animationspeed;var j=0;for(var g=0;g<e.length;g++){f-=50;b(e[g]).stop(false,true).animate({marginTop:0,opacity:1},f,function(){++j;if(j==e.length){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false}})}}function bR(){for(var h=0;h<12;h++){b("<div/>").css({width:Math.ceil(bS.width()/12),height:bS.find("img:eq(0)").height(),marginTop:(bS.find("img:eq(0)").height()),left:Math.ceil((h*bS.width()/12)),position:"absolute",backgroundImage:"url("+bp+")",backgroundPosition:""+(-(h*bS.width()/12))+"px 0px",opacity:0}).appendTo(aX)}var e=aX.find("div");var f=d.animationspeed;var j=0;for(var g=0;g<e.length;g++){f-=50;b(e[g]).stop(false,true).animate({marginTop:0,opacity:1},f,function(){++j;if(j==e.length){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false}})}}function bY(){for(var h=0;h<12;h++){b("<div/>").css({width:Math.ceil(bS.width()/12),height:bS.find("img:eq(0)").height(),marginTop:((h%2==0)?-(bS.find("img:eq(0)").height()):bS.find("img:eq(0)").height()),left:Math.ceil((h*bS.width()/12)),position:"absolute",backgroundImage:"url("+bp+")",backgroundPosition:""+(-(h*bS.width()/12))+"px 0px",opacity:0}).appendTo(aX)}var e=aX.find("div");var f=d.animationspeed;var j=0;for(var g=0;g<e.length;g++){b(e[g]).stop(false,true).animate({marginTop:0,opacity:1},f,function(){++j;if(j==e.length){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false}})}}function bz(){for(var h=0;h<12;h++){b("<div/>").css({width:bS.width(),height:Math.ceil(bS.height()/12),marginLeft:-bS.width(),top:Math.ceil((h*bS.height()/12)),position:"absolute",backgroundImage:"url("+bp+")",backgroundPosition:"0px "+(-(h*bS.height()/12))+"px",opacity:0}).appendTo(aX)}var e=aX.find("div");var f=d.animationspeed;var j=0;for(var g=0;g<e.length;g++){f-=50;b(e[g]).stop(false,true).animate({marginLeft:0,opacity:1},f,function(){++j;if(j==e.length){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false}})}}function a5(){for(var h=0;h<12;h++){b("<div/>").css({width:bS.width(),height:Math.ceil(bS.height()/12),marginLeft:((h%2==0)?-bS.width():bS.width()),top:Math.ceil((h*bS.height()/12)),position:"absolute",backgroundImage:"url("+bp+")",backgroundPosition:"0px "+(-(h*bS.height()/12))+"px",opacity:0}).appendTo(aX)}var e=aX.find("div");var f=d.animationspeed;var j=0;for(var g=0;g<e.length;g++){b(e[g]).stop(false,true).animate({marginLeft:0,opacity:1},f,function(){++j;if(j==e.length){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false}})}}function bi(){var e=Math.ceil(bS.width()/4);var g=Math.ceil(bS.height()/4);for(var f=0;f<4;f++){for(var h=0;h<4;h++){b("<div/>").css({width:e,height:g,left:Math.ceil(h*e),top:Math.ceil(f*g),position:"absolute"}).append(b("<div/>").addClass("checker").css({backgroundImage:"url("+bp+")",width:0,height:0,"background-position":""+(-(h*e))+"px "+(-(f*g))+"px"})).appendTo(aX)}}aX.find(".checker").animate({width:e,height:g},d.animationspeed,function(){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false})}function aR(){var h=Math.ceil(bS.width()/4);var l=Math.ceil(bS.height()/4);for(var f=0;f<4;f++){for(var o=0;o<4;o++){b("<div/>").css({width:h,height:l,left:Math.ceil((bS.width()/2-h/2)),top:Math.ceil((bS.height()/2-l/2)),opacity:0,position:"absolute"}).css("background-image","url("+bp+")").addClass(" "+(o*h)+"").addClass(""+(f*l)+"").css("background-position",""+(-(o*h))+"px "+(-(f*l))+"px").appendTo(aX)}}var m=aX.find("div");var k=0;for(var j=0;j<m.length;j++){var e=b(m[j]);var n=parseFloat(e.attr("class").split(" ")[0]);var g=0;if(j>0){g=parseFloat(e.attr("class").split(" ")[1])}e.stop(false,true).animate({left:n,top:g,opacity:1},d.animationspeed,function(){++k;if(k==m.length){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aX.fadeOut("fase",function(){b(this).remove()});aT=false}})}}function bA(g,f,e,h){g.eq(0).css("display","").animate({width:e,height:h,opacity:1},f,function(){bA(g.slice(1),f,e,h);if(g.length==1){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");aT=false}})}function a9(g,f){var h=Math.floor(Math.random()*(g.length));var j=g.eq(h);if(j.length>0){var e=parseFloat(j.attr("class").split(" ")[0]);var k=0;if(j.attr("class").split(" ").length>1){k=parseFloat(j.attr("class").split(" ")[1])}g.eq(0).css("display","").animate({left:e,top:k,opacity:1},f,function(){a9(g.slice(1),f);if(g.length==1){a2.fadeIn("slow",function(){b(this).css("z-index","100")});bC.css("z-index","98");b(".anim-wrapper").fadeOut("fast");aT=false}})}}})}})})(jQuery);