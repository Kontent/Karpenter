(function(a){a.fn.extend({jsCarousel:function(b){var c=a.extend({scrollspeed:1500,delay:5000,itemstodisplay:5,autoscroll:false,circular:false,masked:true,onthumbnailclick:null,orientation:"h"},b);return this.each(function(){var g="horizontal";if(c.orientation=="v"){g="vertical"}var u=a(this).addClass("jscarousal-contents-"+g+"");var w=a("<div/>").addClass("jscarousal-"+g+"").attr("id",u.attr("id"));var l=a("<div/>").addClass("jscarousal-"+g+"-back");var m=a("<div/>").addClass("jscarousal-"+g+"-forward");u.removeAttr("id");u.before(w);w.append(l);w.append(u);w.append(m);var C=a("> div",u).css("display","none").length;var n=0;var j=0;var v=a("<div/>");var f;var A;var x=c.itemstodisplay;var y=c.scrollspeed;var s;var i;var t;var r;var o;var B="forward";var q=true;function d(){n=-1;f=parseInt(C/x);if(C%x>0){f++}n=f-1;var G=0;var F=x;var I=false;var E=a("> div",u);a("> div",u).remove();if(c.masked){E.addClass("thumbnail-inactive").hover(function(){a(this).removeClass("thumbnail-inactive").addClass("thumbnail-active")},function(){a(this).removeClass("thumbnail-active").addClass("thumbnail-inactive")})}for(var D=0;D<f;D++){if(C>x){G=D*x;F=G+x;if(F>C){G-=(F-C);F=G+x;I=true}}else{G=0;F=C}var H=a("<div/>");E.slice(G,F).each(function(J,K){if(!I){H.append(K)}else{H.append(a(K).clone(true))}});H.find("img").click(function(){if(c.onthumbnailclick!=null){c.onthumbnailclick(a(this).attr("src"))}});u.append(H)}if(c.onthumbnailclick!=null){a("> div > div",u).css("cursor","pointer")}a("> div",u).addClass("hidden");a("> div > div",u).css("display","");if(c.orientation=="v"){s=a("> div:eq("+n+")",u).css("top");if(s=="auto"){s="0px"}r=u.height();t=u.get(0).offsetHeight;a("> div",u).css("top","-"+r+"px");a("> div:eq("+n+")",u).stop(false,true).animate({top:s},y,function(){q=false})}if(c.orientation=="h"){i=a("> div:eq("+n+")",u).css("left");o=u.width();t=u.get(0).offsetHeight;a("> div",u).css("left","-"+o+"px");a("> div:eq("+n+")",u).stop(false,true).animate({left:0},y,function(){q=false})}a("> div:eq("+n+")",u).addClass("visible").removeClass("hidden");w.mouseenter(function(){if(c.autoscroll){e()}}).mouseleave(function(){if(c.autoscroll){k()}});if(c.autoscroll){k()}m.click(function(){if(!q){B="forward";if(c.circular){if(n<=0){n=f}}z()}});l.click(function(){if(!q){B="backward";if(c.circular){if(n>=f-1){n=-1}}z()}})}d();function e(){q=false;clearTimeout(A);w.children().clearQueue();w.children().stop(false,true)}function k(){clearTimeout(A);if(c.autoscroll){A=setTimeout(h,c.delay)}}function h(){if(B=="forward"){if(n<=0){n=f}}else{if(n>=f-1){n=-1}}z();A=setTimeout(h,c.delay)}function p(D){return D+"px"}function z(){q=true;var E=a(".visible",u);var D=y;if(B=="forward"){n--;if(n>=0){if(c.orientation=="v"){a(">div:eq("+n+")",u).css("top",p(r)).removeClass("hidden").addClass("visible").stop(false,true).animate({top:s},D,function(){q=false});E.stop(false,true).animate({top:"-="+p(r)},D,function(){a(this).removeClass("visible").addClass("hidden");a(this).css("top",s);q=false})}else{a(">div:eq("+n+")",u).css("left",p(o)).removeClass("hidden").addClass("visible").stop(false,true).animate({left:"-="+p(o)},D,function(){q=false});E.stop(false,true).animate({left:"-="+p(o)},D,function(){a(this).removeClass("visible").addClass("hidden");a(this).css("left",i);q=false})}}else{n=0}}else{if(B=="backward"){n++;if(n<f){if(c.orientation=="v"){a(">div:eq("+n+")",u).removeClass("hidden").addClass("visible").css({top:p(-r)}).stop(false,true).animate({top:s},D,function(){q=false});E.stop(false,true).animate({top:"+="+p(r)},D,function(){a(this).removeClass("visible").addClass("hidden");a(this).css("top",p(-r));q=false})}else{a(">div:eq("+n+")",u).removeClass("hidden").addClass("visible").css({left:p(-o)}).stop(false,true).animate({left:"+="+p(o)},D,function(){q=false});E.stop(false,true).animate({left:"+="+p(o)},D,function(){a(this).removeClass("visible").addClass("hidden");a(this).css("left",p(-o));q=false})}}else{n=f-1}}}}})}})})(jQuery);